document.addEventListener('DOMContentLoaded', () => {
    // Set default value to December 21, 10:30 PM SGT
    const defaultDate = new Date('2024-12-21T22:30:00+08:00'); // SGT is UTC+8
    const formattedDate = defaultDate.toISOString().slice(0, 16); // Format to 'yyyy-MM-ddTHH:mm'
    document.getElementById('event-date').value = formattedDate;

    // Automatically start the countdown with the pre-populated date
    const eventDate = defaultDate.getTime();
    countdownToEvent(eventDate);
});

let countdownInterval;

// Countdown logic
function countdownToEvent(eventDate) {
    function updateCountdown() {
        const now = new Date().getTime();
        const distance = eventDate - now;

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        document.getElementById('days').textContent = days.toString().padStart(2, '0');
        document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
        document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
        document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');

        if (distance < 0) {
            clearInterval(countdownInterval);
            document.querySelector('.countdown').textContent = "Event has passed!";
        }
    }

    clearInterval(countdownInterval);  // Clear any previous interval
    countdownInterval = setInterval(updateCountdown, 1000);
    updateCountdown();  // Initial call to set the time immediately
}

document.getElementById('start-timer').addEventListener('click', () => {
    const eventDateInput = document.getElementById('event-date').value;
    if (eventDateInput) {
        const eventDate = new Date(eventDateInput).getTime();
        countdownToEvent(eventDate);
    } else {
        alert('Please select a valid date and time.');
    }
});
